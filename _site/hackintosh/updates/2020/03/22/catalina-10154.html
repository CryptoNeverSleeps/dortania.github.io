<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>macOS 10.15.4 update | Dortania</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="macOS 10.15.4 update" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="So today marks the release of macOS 10.15.4, a pretty average release for most users but quite a special one for laptop, Clover and AMD CPU users." />
<meta property="og:description" content="So today marks the release of macOS 10.15.4, a pretty average release for most users but quite a special one for laptop, Clover and AMD CPU users." />
<link rel="canonical" href="http://localhost:4000/hackintosh/updates/2020/03/22/catalina-10154.html" />
<meta property="og:url" content="http://localhost:4000/hackintosh/updates/2020/03/22/catalina-10154.html" />
<meta property="og:site_name" content="Dortania" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-22T07:00:00-06:00" />
<script type="application/ld+json">
{"headline":"macOS 10.15.4 update","dateModified":"2020-03-22T07:00:00-06:00","datePublished":"2020-03-22T07:00:00-06:00","url":"http://localhost:4000/hackintosh/updates/2020/03/22/catalina-10154.html","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/hackintosh/updates/2020/03/22/catalina-10154.html"},"description":"So today marks the release of macOS 10.15.4, a pretty average release for most users but quite a special one for laptop, Clover and AMD CPU users.","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Dortania" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Dortania</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/about/">Getting Started</a><a class="page-link" href="/guides/">Testing page</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">macOS 10.15.4 update</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2020-03-22T07:00:00-06:00" itemprop="datePublished">Mar 22, 2020
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <p>So today marks the release of macOS 10.15.4, a pretty average release for most users but quite a special one for laptop, Clover and AMD CPU users.</p>

<p>For details on what’s changed OS wise:</p>

<ul>
  <li><a href="https://developer.apple.com/documentation/macos_release_notes/macos_catalina_10_15_4_release_notes">Apple Release Notes</a>
    <ul>
      <li>Pretty useless tbh</li>
    </ul>
  </li>
  <li><a href="https://www.macrumors.com/2020/03/24/apple-releases-macos-catalina-10-15-4/">MacRumors</a>
    <ul>
      <li>Much more info</li>
    </ul>
  </li>
</ul>

<h1 id="laptops">Laptops</h1>

<p>With this release, we now have official Ice Lake support! Do note that Apple rarely supports GT1 GPUs for more than a .1 update as more of an accident so be wary. At the moment we know the following iGPUs are supported:</p>

<ul>
  <li>Iris Plus G4</li>
  <li>Iris Plus G7</li>
</ul>

<p>Other issues are:</p>

<ul>
  <li>We still need framebuffer dumps to know the best platform ID</li>
  <li>MacBookAir9,1 isn’t yet supported by <a href="https://github.com/acidanthera/MacInfoPkg">MacInfoPkg</a></li>
  <li>Memory protections are in place breaking AptioMemoryFix, OpenCore, and OcQuirks</li>
</ul>

<p>OpenCore fixed the last one in 0.5.7 thanks to the quirk <code class="language-plaintext highlighter-rouge">ProtectUefiServices</code> which fixes the use of DevirtulizeMMIO allowing the macOS kernel to fit nicely. <code class="language-plaintext highlighter-rouge">ProtectUefiServices</code> has been added to <a href="https://github.com/ReddestDream/OcQuirks/releases">OcQuirks</a> from revision 19. So be patient and don’t rush out to buy a machine <em>just</em> for hackintoshing</p>

<p><strong>Note</strong>: This is only for Icelake laptops, this issue is not related to macOS instead the firmware found on these machines</p>

<h1 id="clover">Clover</h1>

<p>Oh what fun, Clover’s drunk again and won’t boot for some of you! The specific issue seems to be only for Skylake and newer users. The specific of what happened:</p>

<ul>
  <li>Apple added Ice Lake and Comet Lake support to the kernel</li>
  <li>Problem is it wouldn’t fit as-is, so the mask of the processor changed</li>
  <li>This then meant that it turned from 16 bits to 20 bits long</li>
  <li>This then broke Clover’s <code class="language-plaintext highlighter-rouge">KernelPM</code> and <code class="language-plaintext highlighter-rouge">AppleIntelCPUPM</code> patch</li>
</ul>

<p>So because of this change, we have 4 paths to go down:</p>

<ul>
  <li>Disable CFG-Lock in the BIOS
    <ul>
      <li>See <a href="https://khronokernel-2.gitbook.io/opencore-vanilla-desktop-guide/extras/msr-lock">Disabling CFG-Lock Guide</a></li>
    </ul>
  </li>
  <li>Use a CPU ID that still works with the old KernelPM patch
    <ul>
      <li>Broadwell and older are fine</li>
      <li>Note doing this can partially or completely break XCPM</li>
    </ul>
  </li>
  <li>Update to Clover with commit version <a href="https://github.com/CloverHackyColor/CloverBootloader/commit/af8a84f4784f657e8d8937f0a19dc9695e22f6d9">af8a84f</a> or later
    <ul>
      <li><a href="https://github.com/CloverHackyColor/CloverBootloader/releases">r5107</a> is the minimum version, plus recent Cover updates moved to C++ breaking a lot of things so keep a backup</li>
    </ul>
  </li>
  <li>Buy a hackintosh that starts with the letter M</li>
</ul>

<p>For the CPU ID route, you can spoof to a Broadwell-H CPU with the following:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>config.plist -&gt; KernelAndKextPatches -&gt; FakeCPUID -&gt; 0x040674
</code></pre></div></div>

<ul>
  <li>Remember doing this can partially or even completely break XCPM</li>
</ul>

<p>And ofc, OpenCore doesn’t have any issues with this update. Just another nudge to go to the dark side. The specifics behind this is that Clover doesn’t know anything about symbols or structures, and so the patch is very generic whereas OpenCore can be much more precise.</p>

<p><a href="https://applelife.ru/threads/ustanovka-macos-catalina-10-15-na-intel-pc.2944136/page-572#post-866249">Source</a></p>

<h1 id="amd-users">AMD Users</h1>

<p>So with this update, the <code class="language-plaintext highlighter-rouge">CPU Family</code> patch has broken due to Ice Lake and Comet Lake shoving themselves in and changing the placing of families. So users will need to update their Kernel patches, specifically the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Comment: algrey - cpuid_set_cpufamily - force CPUFAMILY_INTEL_PENRYN
Count: 1
Enabled: Yes
Find: 31db803d00000000067500
Replace: bbbc4fea78e95d00000090
Mask: ffffffff000000ffffff00
MaxKernel: 19.99.99
MinKernel: 17.0.0
Skip: 0
</code></pre></div></div>
<p>Credit to <a href="https://github.com/IOIIIO">NoOne</a> for updating the patches.</p>

<p>The <a href="https://github.com/AMD-OSX/AMD_Vanilla">AMD OSX repo</a> has also updated the patches</p>

  </div><a class="u-url" href="/hackintosh/updates/2020/03/22/catalina-10154.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Dortania</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Dortania</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/Dortania"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">Dortania</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Homepage for Dortania Guides</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
