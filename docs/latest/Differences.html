<!DOCTYPE html> 
<html lang="en-US" xml:lang="en-US" > 
<head><title>Differences</title> 
<meta  charset="utf-8" /> 
<meta name="generator" content="TeX4ht (http://www.tug.org/tex4ht/)" /> 
<meta name="viewport" content="width=device-width,initial-scale=1" /> 
<link rel="stylesheet" type="text/css" href="Differences.css" /> 
<meta name="src" content="Differences.tex" /> 
<link rel="stylesheet" type="text/css" href="../main.css" /></head><body 
><div class="center" 
>
<!--l. 137--><p class="noindent" >
</p><!--l. 144--><p class="noindent" > <img 
src="Logos/Logo-.png" alt="PIC"  
width="160" height="160"  />
</p><!--l. 148--><p class="noindent" >OpenCore
</p><!--l. 152--><p class="noindent" >Reference Manual (<span class="sout">0.5.9</span><span class="uwave">0.6.0</span>)
</p><!--l. 156--><p class="noindent" >[2020.07.25]
</p><!--l. 164--><p class="noindent" >Copyright ©2018-2020 vit9696
</p>
</div>
                                                                                                  
                                                                                                  
<h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
<div class="tableofcontents">
<span class="sectionToc" >1 <a 
href="#x1-20001" id="QQ2-1-3">Introduction</a></span>
<br /> <span class="subsectionToc" >2.3 <a 
href="#x1-70003" id="QQ2-1-8">Configuration Structure</a></span>
<br /> <span class="subsectionToc" >3.3 <a 
href="#x1-110003" id="QQ2-1-12">Contribution</a></span>
<br /> <span class="subsectionToc" >3.4 <a 
href="#x1-120004" id="QQ2-1-15">Coding conventions</a></span>
<br /> <span class="subsectionToc" >4.6 <a 
href="#x1-200006" id="QQ2-1-23">Quirks Properties</a></span>
<br /> <span class="subsectionToc" >5.2 <a 
href="#x1-230002" id="QQ2-1-26">Properties</a></span>
<br /> <span class="subsectionToc" >5.3 <a 
href="#x1-240003" id="QQ2-1-27">MmioWhitelist Properties</a></span>
<br /> <span class="subsectionToc" >5.4 <a 
href="#x1-250004" id="QQ2-1-28">Quirks Properties</a></span>
<br /> <span class="subsectionToc" >7.3 <a 
href="#x1-330003" id="QQ2-1-36">Add Properties</a></span>
<br /><span class="sectionToc" >8 <a 
href="#x1-380008" id="QQ2-1-41">Misc</a></span>
<br /> <span class="subsectionToc" >8.1 <a 
href="#x1-390001" id="QQ2-1-42">Introduction</a></span>
<br /> <span class="subsectionToc" >8.2 <a 
href="#x1-400002" id="QQ2-1-43">Properties</a></span>
<br /> <span class="subsectionToc" >8.3 <a 
href="#x1-410003" id="QQ2-1-44">Boot Properties</a></span>
<br /> <span class="subsectionToc" >8.4 <a 
href="#x1-420004" id="QQ2-1-45">Debug Properties</a></span>
<br /> <span class="subsectionToc" >8.5 <a 
href="#x1-430005" id="QQ2-1-46">Security Properties</a></span>
<br /> <span class="subsectionToc" >11.4 <a 
href="#x1-610004" id="QQ2-1-65">OpenCanopy</a></span>
<br /> <span class="subsectionToc" >11.6 <a 
href="#x1-630006" id="QQ2-1-67">Properties</a></span>
<br /> <span class="subsectionToc" >11.7 <a 
href="#x1-640007" id="QQ2-1-68">APFS Properties</a></span>
<br /> <span class="subsectionToc" >11.8 <a 
href="#x1-650008" id="QQ2-1-69">Audio Properties</a></span>
<br /> <span class="subsectionToc" >11.11 <a 
href="#x1-6800011" id="QQ2-1-72">ProtocolOverrides Properties</a></span>
<br /> <span class="subsectionToc" >11.12 <a 
href="#x1-6900012" id="QQ2-1-73">Quirks Properties</a></span>
</div>
<a 
 id="x1-1001r1"></a>
<h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-20001"></a>Introduction</h3>
<!--l. 173--><p class="noindent" >This document provides information on <a 
href="https://github.com/acidanthera/OpenCorePkg" >OpenCore</a> user configuration file format used to setup the correct functioning of
macOS operating system. It is to be read as the official clarification of expected OpenCore behaviour. All deviations, if
found in published OpenCore releases, shall be considered documentation or implementation bugs, and are
requested to be reported through <a 
href="https://github.com/acidanthera/bugtracker" >Acidanthera Bugtracker</a>. <span class="uwave">Errata sheet is available in </span><a 
href="https://github.com/acidanthera/OpenCorePkg/blob/master/Docs/Errata/Errata.pdf" >OpenCorePkg repository</a><span class="uwave">.
</span>
</p><!--l. 184--><p class="noindent" >This document is structured as a specification, and is not meant to provide a step by step algorithm for configuring end-user
board support package (BSP). The intended audience of the document are programmers and engineers with
basic understanding of macOS internals and UEFI functioning. For these reasons this document is available
exclusively in English, and all other sources or translations of this document are unofficial and may contain
errors.
</p><!--l. 191--><p class="noindent" >Third-party articles, utilities, books, and alike may be more useful for a wider audience as they could provide guide-like
material. However, they are prone to their authors’ preferences, tastes, this document misinterpretation, and essential
obsolescence. In case you use these sources, for example, <a 
href="https://dortania.github.io" >Dortania</a>’s <a 
href="https://dortania.github.io/OpenCore-Install-Guide" >OpenCore Install Guide</a> and <a 
href="https://dortania.github.io/getting-started" >related material</a>, please ensure
to follow this document for every made decision and judge its consequences.
                                                                                                  
                                                                                                  
invalid values. Recommended practice of interpreting invalid values is to conform to the following convention where
applicable:
<a 
 id="x1-6001r1"></a></p>
<!--l. 373--><div class="longtable"> <table id="TBL-1" class="longtable" 
cellspacing="0" cellpadding="0"  
><colgroup id="TBL-1-1g"><col 
id="TBL-1-1" /><col 
id="TBL-1-2" /></colgroup>
<tr  
 style="vertical-align:baseline;" id="TBL-1-1-"><td colspan="2" style="white-space:nowrap; text-align:left;" id="TBL-1-1-1"  
class="td01"><span class="cmidrule"><!-- enable post-processing of cmidrule--></span>
</td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-2-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-2-1"  
class="td01">Type</td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-2-2"  
class="td10">Value</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-3-"><td colspan="2" style="white-space:nowrap; text-align:left;" id="TBL-1-3-1"  
class="td01"><span class="cmidrule"><!-- enable post-processing of cmidrule--></span>
</td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-4-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-4-1"  
class="td01">    </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-5-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-5-1"  
class="td01">    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-5-2"  
class="td10">
</td></tr>
<tr  
 style="vertical-align:baseline;" id="TBL-1-6-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-6-1"  
class="td01">plist string  </td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-6-2"  
class="td10">Empty string (&#x003C;string&#x003E;&#x003C;/string&#x003E;)</td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-7-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-7-1"  
class="td01">plist data    </td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-7-2"  
class="td10">Empty data (&#x003C;data&#x003E;&#x003C;/data&#x003E;)        </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-8-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-8-1"  
class="td01">plist integer </td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-8-2"  
class="td10">0 (&#x003C;integer&#x003E;0&#x003C;/integer&#x003E;)           </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-9-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-9-1"  
class="td01">plist boolean </td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-9-2"  
class="td10">False (&#x003C;false/&#x003E;)                         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-10-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-10-1"  
class="td01">plist tristate</td><td  style="white-space:nowrap; text-align:left;" id="TBL-1-10-2"  
class="td10">False (&#x003C;false/&#x003E;)                         </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-11-"><td colspan="2" style="white-space:nowrap; text-align:left;" id="TBL-1-11-1"  
class="td01"><span class="cmidrule"><!-- enable post-processing of cmidrule--></span>
</td></tr><tr  
 style="vertical-align:baseline;" id="TBL-1-12-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-12-1"  
class="td01">              </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-13-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-13-1"  
class="td01">              </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-14-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-14-1"  
class="td01">              </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-15-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-15-1"  
class="td01">              </td>
</tr><tr  
 style="vertical-align:baseline;" id="TBL-1-16-"><td  style="white-space:nowrap; text-align:left;" id="TBL-1-16-1"  
class="td01">              </td>
</tr>
</table></div>
<a 
 id="x1-6002r7"></a>
<h4 class="subsectionHead"><span class="titlemark">2.3   </span> <a 
 id="x1-70003"></a>Configuration Structure</h4>
<!--l. 391--><p class="noindent" >OC config is separated into following sections, which are described in separate sections of this document. By default it is tried
to not enable anything and optionally provide kill switches with Enable property for plist dict entries. In general the
configuration is written idiomatically to group similar actions in subsections:
</p>
     <ul class="itemize1">
     <li class="itemize">Add provides support for data addition. Existing data will not be overridden, and needs to be handled separately
     with Delete if necessary.
     </li>
     <li class="itemize">Delete provides support for data removal.
     </li>
     <li class="itemize">Patch provides support for data modification.
     </li>
     <li class="itemize">Quirks provides support for specific hacks.</li></ul>
<!--l. 411--><p class="noindent" >Root configuration entries consist of the following:
</p>
     <ul class="itemize1">
     <li class="itemize">??
     </li>
     <li class="itemize">??
     </li>
     <li class="itemize">??
     </li>
     <li class="itemize">??
     </li>
     <li class="itemize"><a 
href="#x1-380008">Misc</a>
     </li>
     <li class="itemize">??
     </li>
     <li class="itemize">??
     </li>
     <li class="itemize">??</li></ul>
<!--l. 433--><p class="noindent" >It is possible to perform basic validation of the configuration by using <span class="sout">ConfigValidity</span><span class="uwave">ocvalidate</span> utility. Please note, that
<span class="sout">ConfigValidity</span><span class="uwave">ocvalidate</span> must match the used OpenCore release and may not be able to detect all configuration flaws
present in the file.
                                                                                                  
                                                                                                  
document available in OpenCore repository. Vaulting information is provided in <a 
href="#x1-430005">Security Properties</a> section of this
document.
</p><!--l. 625--><p class="noindent" >OC config, just like any property lists can be edited with any stock textual editor (e.g. nano, vim), but specialised software
may provide better experience. On macOS the preferred GUI application is <a 
href="https://developer.apple.com/xcode" >Xcode</a>. For a lightweight cross-platform and
open-source alternative <a 
href="https://github.com/corpnewt/ProperTree" >ProperTree</a> editor can be utilised.
</p><!--l. 633--><p class="noindent" >For BIOS booting a third-party UEFI environment provider will have to be used. OpenDuetPkg is one of the known UEFI
environment providers for legacy systems. To run OpenCore on such a legacy system you can install OpenDuetPkg with a
dedicated tool — BootInstall (bundled with OpenCore). <a 
href="https://github.com/corpnewt/gibMacOS" >Third-party utilities</a> can be used to perform this on systems different
from macOS.
</p><!--l. 640--><p class="noindent" >For upgrade purposes refer to Differences.pdf document, providing the information about the changes affecting the
configuration compared to the previous release, and Changelog.md document, containing the list of modifications across all
published updates.
<a 
 id="x1-10001r11"></a>
</p>
<h4 class="subsectionHead"><span class="titlemark">3.3   </span> <a 
 id="x1-110003"></a>Contribution</h4>
<!--l. 647--><p class="noindent" >OpenCore can be compiled as an ordinary <a 
href="https://github.com/tianocore/tianocore.github.io/wiki/EDK-II" >EDK II</a> package. Since <a 
href="https://github.com/tianocore/tianocore.github.io/wiki/UDK" >UDK</a> development was abandoned by TianoCore, OpenCore
requires the use of <a 
href="https://github.com/tianocore/tianocore.github.io/wiki/EDK-II#stable-tags" >EDK II Stable</a>. Currently supported EDK II release is hosted in <a 
href="https://github.com/acidanthera/audk" >acidanthera/audk</a>. The required patches for
the package are present in Patches directory.
</p><!--l. 656--><p class="noindent" >The only officially supported toolchain is XCODE5. Other toolchains might work, but are neither supported, nor recommended.
Contribution of clean patches is welcome. Please do follow <a 
href="https://github.com/tianocore/tianocore.github.io/wiki/Code-Style-C" >EDK II C Codestyle</a>.
</p><!--l. 661--><p class="noindent" >To compile with XCODE5, besides <a 
href="https://developer.apple.com/xcode" >Xcode</a>, one should also install <a 
href="https://www.nasm.us" >NASM</a> and <a 
href="https://github.com/acidanthera/ocbuild/tree/master/external" >MTOC</a>. The latest Xcode version is recommended
for use despite the toolchain name. Example command sequence may look as follows:
</p>
<!--l. 668-->
<a 
 id="x1-11001r1"></a>
<a 
 id="x1-11002"></a>
<div class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-11003r1"></a></span><span class="sout">git</span><span class="sout"> </span><span class="sout">clone</span><span class="sout"> </span><span class="sout">https</span><span class="sout">://</span><span class="sout">github</span><span class="sout">.</span><span class="sout">com</span><span class="sout">/</span><span class="sout">acidanthera</span><span class="sout">/</span><span class="sout">audk</span><span class="sout"> </span><span class="sout">UDK</span> <br /><span class="label"><a 
 id="x1-11004r2"></a></span><span class="uwave">git</span><span class="uwave"> </span><span class="uwave">clone</span><span class="uwave"> </span><span class="uwave">-</span><span class="uwave">-</span><span class="uwave">recursive</span><span class="uwave"> </span><span class="uwave">-</span><span class="uwave">-</span><span class="uwave">depth</span><span class="uwave">=1</span><span class="uwave"> </span><span class="uwave">https</span><span class="uwave">://</span><span class="uwave">github</span><span class="uwave">.</span><span class="uwave">com</span><span class="uwave">/</span><span class="uwave">acidanthera</span><span class="uwave">/</span><span class="uwave">audk</span><span class="uwave"> </span><span class="uwave">UDK</span> <br /><span class="label"><a 
 id="x1-11005r3"></a></span>cd UDK <br /><span class="label"><a 
 id="x1-11006r4"></a></span>git clone https://github.com/acidanthera/OpenCorePkg <br /><span class="label"><a 
 id="x1-11007r5"></a></span>source edksetup.sh <br /><span class="label"><a 
 id="x1-11008r6"></a></span>make -C BaseTools <br /><span class="label"><a 
 id="x1-11009r7"></a></span>build -a X64 -b RELEASE -t XCODE5 -p OpenCorePkg/OpenCorePkg.dsc
<figcaption class="caption" ><span class="id">Listing 1:</span><span  
class="content">Compilation Commands</span></figcaption><!--tex4ht:label?: x1-11001r -->
</div>
<!--l. 679--><p class="noindent" >For IDE usage Xcode projects are available in the root of the repositories. Another approach could be <a 
href="https://www.sublimetext.com" >Sublime Text</a> with
<a 
href="https://niosus.github.io/EasyClangComplete" >EasyClangComplete</a> plugin. Add .clang_complete file with similar content to your UDK root:
</p>
<!--l. 684-->
<a 
 id="x1-11010r2"></a>
<a 
 id="x1-11011"></a>
<div class="lstlisting" id="listing-2"><span class="label"><a 
 id="x1-11012r1"></a></span>-I/UefiPackages/MdePkg <br /><span class="label"><a 
 id="x1-11013r2"></a></span>-I/UefiPackages/MdePkg/Include <br /><span class="label"><a 
 id="x1-11014r3"></a></span>-I/UefiPackages/MdePkg/Include/X64 <br /><span class="label"><a 
 id="x1-11015r4"></a></span>-I/UefiPackages/MdeModulePkg <br /><span class="label"><a 
 id="x1-11016r5"></a></span>-I/UefiPackages/MdeModulePkg/Include <br /><span class="label"><a 
 id="x1-11017r6"></a></span>-I/UefiPackages/MdeModulePkg/Include/X64 <br /><span class="label"><a 
 id="x1-11018r7"></a></span>-I/UefiPackages/OpenCorePkg/Include/AMI <br /><span class="label"><a 
 id="x1-11019r8"></a></span>-I/UefiPackages/OpenCorePkg/Include/Acidanthera <br /><span class="label"><a 
 id="x1-11020r9"></a></span>-I/UefiPackages/OpenCorePkg/Include/Apple <br /><span class="label"><a 
 id="x1-11021r10"></a></span>-I/UefiPackages/OpenCorePkg/Include/Apple/X64 <br /><span class="label"><a 
 id="x1-11022r11"></a></span>-I/UefiPackages/OpenCorePkg/Include/Duet <br /><span class="label"><a 
 id="x1-11023r12"></a></span>-I/UefiPackages/OpenCorePkg/Include/Generic <br /><span class="label"><a 
 id="x1-11024r13"></a></span>-I/UefiPackages/OpenCorePkg/Include/Intel <br /><span class="label"><a 
 id="x1-11025r14"></a></span>-I/UefiPackages/OpenCorePkg/Include/Microsoft <br /><span class="label"><a 
 id="x1-11026r15"></a></span>-I/UefiPackages/OpenCorePkg/Include/VMware <br /><span class="label"><a 
 id="x1-11027r16"></a></span>-I/UefiPackages/OvmfPkg/Include <br /><span class="label"><a 
 id="x1-11028r17"></a></span>-I/UefiPackages/UefiCpuPkg/Include <br /><span class="label"><a 
 id="x1-11029r18"></a></span>-IInclude <br /><span class="label"><a 
 id="x1-11030r19"></a></span>-include <br /><span class="label"><a 
 id="x1-11031r20"></a></span>/UefiPackages/MdePkg/Include/Uefi.h <br /><span class="label"><a 
 id="x1-11032r21"></a></span>-fshort-wchar <br /><span class="label"><a 
 id="x1-11033r22"></a></span>-Wall <br /><span class="label"><a 
 id="x1-11034r23"></a></span>-Wextra <br /><span class="label"><a 
 id="x1-11035r24"></a></span>-Wno-unused-parameter <br /><span class="label"><a 
 id="x1-11036r25"></a></span>-Wno-missing-braces <br /><span class="label"><a 
 id="x1-11037r26"></a></span>-Wno-missing-field-initializers <br /><span class="label"><a 
 id="x1-11038r27"></a></span>-Wno-tautological-compare <br /><span class="label"><a 
 id="x1-11039r28"></a></span>-Wno-sign-compare <br /><span class="label"><a 
 id="x1-11040r29"></a></span>-Wno-varargs <br /><span class="label"><a 
 id="x1-11041r30"></a></span>-Wno-unused-const-variable <br /><span class="label"><a 
 id="x1-11042r31"></a></span>-DOC_TARGET_NOOPT=1 <br /><span class="label"><a 
 id="x1-11043r32"></a></span>-DNO_MSABI_VA_FUNCS=1
<figcaption class="caption" ><span class="id">Listing 2:</span><span  
class="content">ECC Configuration</span></figcaption><!--tex4ht:label?: x1-11010r -->
</div>
<!--l. 719--><p class="noindent" >Warning: Tool developers modifying config.plist or any other OpenCore files must ensure that their tool checks for
opencore-version NVRAM variable (see <a 
href="#x1-420004">Debug Properties</a> section below) and warn the user if the version listed is
unsupported or prerelease. OpenCore configuration may change across the releases and the tool shall ensure that it carefully
follows this document. Failure to do so may result in this tool to be considered as malware and blocked with all possible
means.
<a 
 id="x1-11044r12"></a>
                                                                                                  
                                                                                                  
     _STA method  with  if ((OSFL () == Zero)) { If (HPTE) ... Return (Zero) content  may  be  forced  to
     always return 0xF by replacing A0 10 93 4F 53 46 4C 00 with A4 0A 0F A3 A3 A3 A3 A3.
     </li>
     <li class="itemize">To provide custom method implementation with in an SSDT, for instance, to report functional key presses on a
     laptop, the original method can be replaced with a dummy name by patching _Q11 with XQ11.</li></ul>
<!--l. 1138--><p class="noindent" >Tianocore <a 
href="https://github.com/acidanthera/audk/blob/master/MdePkg/Include/IndustryStandard/AcpiAml.h" >AcpiAml.h</a> source file may help understanding ACPI opcodes.
</p><!--l. 1141--><p class="noindent" >Note: Patches of different Find and Replace lengths are unsupported as they may corrupt ACPI tables and make you system
unstable due to area relocation. If you need such changes you may <span class="sout">utilities </span><span class="uwave">utilise </span>“proxy” patching or NOP the remaining
area.
<a 
 id="x1-19025r22"></a>
</p>
<h4 class="subsectionHead"><span class="titlemark">4.6   </span> <a 
 id="x1-200006"></a>Quirks Properties</h4>
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-20002x1">FadtEnableReset<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Provide reset register and flag in FADT table to enable reboot and shutdown.
     <!--l. 1157--><p class="noindent" >Mainly required on legacy hardware and few laptops. Can also fix power-button shortcuts. Not recommended
     unless required.
     </p></li>
     <li 
  class="enumerate" id="x1-20004x2">NormalizeHeaders<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description:  Cleanup  ACPI  header  fields  to  workaround  macOS  ACPI  implementation  bug  causing  boot
     crashes. Reference: <a 
href="https://alextjam.es/debugging-appleacpiplatform/" >Debugging AppleACPIPlatform on 10.13</a> by Alex James aka theracermaster. The issue is
     fixed in macOS Mojave (10.14).
     </li>
     <li 
  class="enumerate" id="x1-20006x3">RebaseRegions<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Attempt to heuristically relocate ACPI memory regions. Not recommended.
     <!--l. 1177--><p class="noindent" >ACPI   tables   are   often   generated   dynamically   by   underlying   firmware   implementation.   Among   the
     position-independent  code,  ACPI  tables  may  contain  physical  addresses  of  MMIO  areas  used  for  device
     configuration,  usually  grouped  in  regions  (e.g.  OperationRegion).  Changing  firmware  settings  or  hardware
     configuration, upgrading or patching the firmware inevitably leads to changes in dynamically generated ACPI
     code, which sometimes lead to the shift of the addresses in aforementioned OperationRegion constructions.
     </p><!--l. 1187--><p class="noindent" >For this reason it is very dangerous to apply any kind of modifications to ACPI tables. The most reasonable
     approach is to make as few as possible changes to ACPI and try to not replace any tables, especially DSDT.
     When this is not possible, then at least attempt to ensure that custom DSDT is based on the most recent DSDT
     or remove writes and reads for the affected areas.
     </p><!--l. 1194--><p class="noindent" >When nothing else helps this option could be tried to avoid stalls at PCI Configuration Begin phase of macOS
     booting by attempting to fix the ACPI addresses. It does not do magic, and only works with most common cases.
     Do not use unless absolutely required.
     </p></li>
     <li 
  class="enumerate" id="x1-20008x4">ResetHwSig<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Reset FACS table HardwareSignature value to 0.
     <!--l. 1206--><p class="noindent" >This works around firmwares that fail to maintain hardware signature across the reboots and cause issues with
     waking from hibernation.
                                                                                                  
                                                                                                  
</div>
<!--l. 1284--><p class="noindent" >Note: These settings may reset at hardware change and in certain other circumstances. To view their current state use pmset
-g command in Terminal.
<a 
 id="x1-22004r25"></a>
</p>
<h4 class="subsectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-230002"></a>Properties</h4>
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-23002x1">MmioWhitelist<br 
class="newline" />Type: plist array<br 
class="newline" />Description: Designed to be filled with plist dict values, describing addresses critical for particular firmware
     functioning when DevirtualiseMmio quirk is in use. See <a 
href="#x1-240003">MmioWhitelist Properties</a> section below.
     </li>
     <li 
  class="enumerate" id="x1-23004x2">Quirks<br 
class="newline" />Type: plist dict<br 
class="newline" />Description: Apply individual booter quirks described in <a 
href="#x1-250004">Quirks Properties</a> section below.
     </li></ol>
<a 
 id="x1-23005r26"></a>
<h4 class="subsectionHead"><span class="titlemark">5.3   </span> <a 
 id="x1-240003"></a>MmioWhitelist Properties</h4>
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-24002x1">Address<br 
class="newline" />Type: plist integer<br 
class="newline" />Failsafe: 0<br 
class="newline" />Description: Exceptional MMIO address, which memory descriptor should be left virtualised (unchanged) by
     DevirtualiseMmio. This means that the firmware will be able to directly communicate with this memory region
     during operating system functioning, because the region this value is in will be assigned a virtual address.
     <!--l. 1320--><p class="noindent" >The  addresses  written  here  must  be  part  of  the  memory  map,  have  EfiMemoryMappedIO type  and
     EFI_MEMORY_RUNTIME attribute (highest bit) set. To find the list of the candidates the debug log can be used.
     </p></li>
     <li 
  class="enumerate" id="x1-24004x2">Comment<br 
class="newline" />Type: plist string<br 
class="newline" />Failsafe: Empty string<br 
class="newline" />Description: Arbitrary ASCII string used to provide human readable reference for the entry. It is implementation
     defined whether this value is used.
     </li>
     <li 
  class="enumerate" id="x1-24006x3">Enabled<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: This address will be devirtualised unless set to true.
     </li></ol>
<a 
 id="x1-24007r27"></a>
<h4 class="subsectionHead"><span class="titlemark">5.4   </span> <a 
 id="x1-250004"></a>Quirks Properties</h4>
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-25002x1">AvoidRuntimeDefrag<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Protect from boot.efi runtime memory defragmentation.
     <!--l. 1350--><p class="noindent" >This option fixes UEFI runtime services (date, time, NVRAM, power control, etc.) support on many firmwares
     using SMM backing for select services like variable storage. SMM may try to access physical addresses, but they
     get moved by boot.efi.
                                                                                                  
                                                                                                  
     </p><!--l. 1354--><p class="noindent" >Note: Most but Apple and VMware firmwares need this quirk. <span class="uwave">This quirk is generally unnecessary when using
     </span><span class="uwave">OpenDuetPkg</span><span class="uwave">, but may be required to boot macOS 10.6 and earlier for unclear reasons. </span>
     </p></li>
     <li 
  class="enumerate" id="x1-25004x2">DevirtualiseMmio<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Remove runtime attribute from select MMIO regions.
     <!--l. 1368--><p class="noindent" >This option reduces stolen memory footprint from the memory map by removing runtime bit for known memory
     regions. This quirk may result in the increase of KASLR slides available, but is not necessarily compatible with
     the target board without additional measures. In general this frees from 64 to 256 megabytes of memory (present
     in the debug log), and on some platforms it is the only way to boot macOS, which otherwise fails with allocation
     error at bootloader stage.
     </p><!--l. 1376--><p class="noindent" >This option is generally useful on all firmwares except some very old ones, like Sandy Bridge. On select firmwares
     it may require a list of exceptional addresses that still need to get their virtual addresses for proper NVRAM
     and hibernation functioning. Use MmioWhitelist section to do this.
     </p></li>
     <li 
  class="enumerate" id="x1-25006x3">DisableSingleUser<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Disable single user mode.
     <!--l. 1387--><p class="noindent" >This is a security option allowing one to restrict single user mode usage by ignoring CMD+S hotkey and -s boot
     argument. The behaviour with this quirk enabled is supposed to match T2-based model behaviour. Read <a 
href="https://support.apple.com/HT201573" >this
     article</a> to understand how to use single user mode with this quirk enabled.
     </p></li>
     <li 
  class="enumerate" id="x1-25008x4">DisableVariableWrite<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Protect from macOS NVRAM write access.
     <!--l. 1399--><p class="noindent" >This  is  a  security  option  allowing  one  to  restrict  NVRAM  access  in  macOS.  This  quirk  requires
     OC_FIRMWARE_RUNTIME protocol implemented in OpenRuntime.efi.
     </p><!--l. 1403--><p class="noindent" >Note: This quirk can also be used as an ugly workaround to buggy UEFI runtime services implementations that
     fail to write variables to NVRAM and break the rest of the operating system.
     </p></li>
     <li 
  class="enumerate" id="x1-25010x5">DiscardHibernateMap<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Reuse original hibernate memory map.
     <!--l. 1413--><p class="noindent" >This option forces XNU kernel to ignore newly supplied memory map and assume that it did not change after
     waking from hibernation. This behaviour is required to work by Windows, which mandates to <a 
href="https://docs.microsoft.com/en-us/windows-hardware/design/device-experiences/oem-uefi#hibernation-state-s4-transition-requirements" >preserve</a> runtime
     memory size and location after S4 wake.
     </p><!--l. 1419--><p class="noindent" >Note: This may be used to workaround buggy memory maps on older hardware, and is now considered rare
     legacy. Examples of such hardware are Ivy Bridge laptops with Insyde firmware, like Acer V3-571G. Do not use
     this unless you fully understand the consequences.
     </p></li>
     <li 
  class="enumerate" id="x1-25012x6">EnableSafeModeSlide<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Patch bootloader to have KASLR enabled in safe mode.
     <!--l. 1430--><p class="noindent" >This option is relevant to the users that have issues booting to safe mode (e.g. by holding shift or using -x
     boot argument). By default safe mode forces 0 slide as if the system was launched with slide=0 boot argument.
     This quirk tries to patch boot.efi to lift that limitation and let some other value (from 1 to 255) be used. This
                                                                                                  
                                                                                                  
     quirk requires ProvideCustomSlide to be enabled.
     </p><!--l. 1437--><p class="noindent" >Note: The necessity of this quirk is determined by safe mode availability. If booting to safe mode fails, this option
     can be tried to be enabled.
     </p></li>
     <li 
  class="enumerate" id="x1-25014x7">EnableWriteUnprotector<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Permit write access to UEFI runtime services code.
     <!--l. 1446--><p class="noindent" >This option bypasses R<span class='accenthat'>X</span> permissions in code pages of UEFI runtime services by removing write protection (WP)
     bit from CR0 register during their execution. This quirk requires OC_FIRMWARE_RUNTIME protocol implemented
     in OpenRuntime.efi.
     </p><!--l. 1451--><p class="noindent" >Note: This quirk may potentially weaken firmware security, please use RebuildAppleMemoryMap if your firmware
     supports memory attributes table (MAT). <span class="uwave">Refer to </span><span class="uwave">OCABC: MAT support is 1/0</span><span class="uwave">log entry to determine whether
     MAT is supported. </span>
     </p></li>
     <li 
  class="enumerate" id="x1-25016x8">ForceExitBootServices<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Retry ExitBootServices with new memory map on failure.
     <!--l. 1462--><p class="noindent" >Try to ensure that ExitBootServices call succeeds even with outdated MemoryMap key argument by obtaining
     current memory map and retrying ExitBootServices call.
     </p><!--l. 1465--><p class="noindent" >Note: The necessity of this quirk is determined by early boot crashes of the firmware. Do not use this unless you
     fully understand the consequences.
     </p></li>
     <li 
  class="enumerate" id="x1-25018x9">ProtectMemoryRegions<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Protect memory regions from incorrect access.
     <!--l. 1474--><p class="noindent" >Some firmwares incorrectly map select memory regions:
</p>
         <ul class="itemize1">
         <li class="itemize">CSM region can be marked as boot services code or data, which leaves it as free memory for XNU kernel.
         </li>
         <li class="itemize">MMIO regions can be marked as reserved memory and stay unmapped, but may be required to be accessible
         at runtime for NVRAM support.</li></ul>
     <!--l. 1484--><p class="noindent" >This quirk attempts to fix types of these regions, e.g. ACPI NVS for CSM or MMIO for MMIO.
     </p><!--l. 1487--><p class="noindent" >Note: The necessity of this quirk is determined by artifacts, sleep wake issues, and boot failures. In general only very old
     firmwares need this quirk.
     </p></li>
     <li 
  class="enumerate" id="x1-25020x10">ProtectSecureBoot<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Protect UEFI Secure Boot variables from being written.
     <!--l. 1497--><p class="noindent" >Reports security violation during attempts to write to db, dbx, PK, and KEK variables from the operating
     system.
     </p><!--l. 1500--><p class="noindent" >Note: This quirk mainly attempts to avoid issues with NVRAM implementations with problematic defragmentation, such
     as select Insyde or MacPro5,1.
     </p></li>
     <li 
  class="enumerate" id="x1-25022x11">ProtectUefiServices<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Protect UEFI services from being overridden by the firmware.
     <!--l. 1509--><p class="noindent" >Some modern firmwares including both hardware and virtual machines, like VMware, may update pointers to UEFI
     services during driver loading and related actions. Consequentially this directly breaks other quirks that affect memory
     management, like DevirtualiseMmio, ProtectMemoryRegions, or RebuildAppleMemoryMap, and may also break other
     quirks depending on the effects of these.
     </p><!--l. 1515--><p class="noindent" >Note: On VMware the need for this quirk may be diagnosed by “Your Mac OS guest might run unreliably with more
     than one virtual core.” message.
     </p></li>
     <li 
  class="enumerate" id="x1-25024x12">ProvideCustomSlide<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Provide custom KASLR slide on low memory.
     <!--l. 1524--><p class="noindent" >This option performs memory map analysis of your firmware and checks whether all slides (from 1 to 255) can be used.
     As boot.efi generates this value randomly with rdrand or pseudo randomly rdtsc, there is a chance of boot failure
     when it chooses a conflicting slide. In case potential conflicts exist, this option forces macOS to use a pseudo random
     value among the available ones. This also ensures that slide= argument is never passed to the operating system for
     security reasons.
     </p><!--l. 1532--><p class="noindent" >Note: The necessity of this quirk is determined by OCABC: Only N/256 slide values are usable! message in the
     debug log. If the message is present, this option is to be enabled.
     </p></li>
     <li 
  class="enumerate" id="x1-25026x13"><span class="uwave">ProvideMaxSlide</span><br 
class="newline" /><span class="uwave">Type</span><span class="uwave">: </span><span class="uwave">plist integer</span><br 
class="newline" /><span class="uwave">Failsafe</span><span class="uwave">: </span><span class="uwave">0</span><br 
class="newline" /><span class="uwave">Description</span><span class="uwave">: Provide maximum KASLR slide when higher ones are unavailable. </span>
     <!--l. 1544--><p class="noindent" ><span class="uwave">This option overrides the maximum slide of 255 by a user specified value between 1 and 254 inclusive when
     </span><span class="uwave">ProvideCustomSlide</span> <span class="uwave">is enabled. It is believed that modern firmwares allocate pool memory from top to bottom,
     effectively resulting in free memory at the time of slide scanning being later used as temporary memory
     during kernel loading. In case those memory are unavailable, this option can stop evaluating higher slides.
     </span>
     </p><!--l. 1551--><p class="noindent" ><span class="uwave">Note</span><span class="uwave">: The necessity of this quirk is determined by random boot failure when </span><span class="uwave">ProvideCustomSlide</span> <span class="uwave">is enabled and the
     randomized slide fall into the unavailable range. When </span><span class="uwave">AppleDebug</span> <span class="uwave">is enabled, usually the debug log may contain
     messages like </span><span class="uwave">AAPL: </span>[<span class="uwave">EB|‘LD:LKC</span>] <span class="uwave">} Err(0x9)</span><span class="uwave">. To find the optimal value, manually append </span><span class="uwave">slide=X</span> <span class="uwave">to </span><span class="uwave">boot-args</span> <span class="uwave">and
     log the largest one that won’t cause boot failure. </span>
     </p></li>
     <li 
  class="enumerate" id="x1-25028x14">RebuildAppleMemoryMap<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false<br 
class="newline" />Description: Generate Memory Map compatible with macOS.
     <!--l. 1565--><p class="noindent" >Apple kernel has several limitations in parsing UEFI memory map:
</p>
         <ul class="itemize1">
         <li class="itemize">Memory map size must not exceed 4096 bytes as Apple kernel maps it as a single 4K page. Since some
         firmwares have very large memory maps (approximately over 100 entries) Apple kernel will crash at boot.
         </li>
         <li class="itemize">Memory attributes table is ignored. EfiRuntimeServicesCode memory statically gets RX permissions, and
         all other memory types get RW permissions. Since some firmware drivers may write to global variables
         at  runtime,  Apple  kernel  will  crash  at  calling  UEFI  runtime  services,  unless  driver  .data section  has
         EfiRuntimeServicesData type.</li></ul>
     <!--l. 1580--><p class="noindent" >To workaround these limitations this quirk applies memory attributes table permissions to memory map passed to Apple
                                                                                                  
                                                                                                  
<h4 class="subsectionHead"><span class="titlemark">7.2   </span> <a 
 id="x1-320002"></a>Properties</h4>
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-32002x1">Add<br 
class="newline" />Type: plist array<br 
class="newline" />Failsafe: Empty<br 
class="newline" />Description: Load selected kernel drivers from OC/Kexts directory.
     <!--l. 1732--><p class="noindent" >Designed to be filled with plist dict values, describing each driver. See <a 
href="#x1-330003">Add Properties</a> section below. Kernel
     driver load order follows the item order in the array, thus the dependencies should be written prior to their
     consumers.
     </p><!--l. 1737--><p class="noindent" ><span class="uwave">To track the dependency order one can inspect the </span><span class="uwave">OSBundleLibraries</span> <span class="uwave">key in the </span><span class="uwave">Info.plist</span> <span class="uwave">of the kext. Any
     kext mentioned in the </span><span class="uwave">OSBundleLibraries</span> <span class="uwave">of the other kext must be precede this kext. </span>
     </p><!--l. 1742--><p class="noindent" ><span class="uwave">Note</span><span class="uwave">: Kexts may have inner kexts (</span><span class="uwave">Plug-Ins</span><span class="uwave">) in their bundle. Each inner kext must be added separately. </span>
     </p></li>
     <li 
  class="enumerate" id="x1-32004x2">Block<br 
class="newline" />Type: plist array<br 
class="newline" />Failsafe: Empty<br 
class="newline" />Description: Remove selected kernel drivers from prelinked kernel.
     <!--l. 1752--><p class="noindent" >Designed to be filled with plist dictionary values, describing each blocked driver. See ?? section below.
     </p></li>
     <li 
  class="enumerate" id="x1-32006x3">Emulate<br 
class="newline" />Type: plist dict<br 
class="newline" />Description: Emulate select hardware in kernelspace via parameters described in ?? section below.
     </li>
     <li 
  class="enumerate" id="x1-32008x4">Patch<br 
class="newline" />Type: plist array<br 
class="newline" />Failsafe: Empty<br 
class="newline" />Description: Perform binary patches in kernel and drivers prior to driver addition and removal.
     <!--l. 1768--><p class="noindent" >Designed to be filled with plist dictionary values, describing each patch. See ?? section below.
     </p></li>
     <li 
  class="enumerate" id="x1-32010x5">Quirks<br 
class="newline" />Type: plist dict<br 
class="newline" />Description: Apply individual kernel and driver quirks described in ?? section below.
     </li></ol>
<a 
 id="x1-32011r35"></a>
<h4 class="subsectionHead"><span class="titlemark">7.3   </span> <a 
 id="x1-330003"></a>Add Properties</h4>
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-33002x1">BundlePath<br 
class="newline" />Type: plist string<br 
class="newline" />Failsafe: Empty string<br 
class="newline" />Description: Kext bundle path (e.g. Lilu.kext or MyKext.kext/Contents/PlugIns/MySubKext.kext).
     </li>
     <li 
  class="enumerate" id="x1-33004x2">Comment<br 
class="newline" />Type: plist string<br 
class="newline" />Failsafe: Empty string<br 
class="newline" />Description: Arbitrary ASCII string used to provide human readable reference for the entry. It is implementation
     defined whether this value is used.
     </li>
     <li 
  class="enumerate" id="x1-33006x3">Enabled<br 
class="newline" />Type: plist boolean<br 
class="newline" />Failsafe: false                                                                                                   </body>
</html>